@page "/surveya1"
@page "/surveya1/{HC}"
@inject Models.EmployeeContext DBContext

@using FirstBlazorApp.Models
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime

<div class="row" style='border-style: dotted;border-width: 1px'>
		<div class="col-lg-12">
		<label for="firstName"><b>ตอนที่ 1 ข้อมูลสมาชิกในครัวเรือน (ทุนมนุษย์) (1/5)  (หน้าที่ 2/20)</b></label>
		<label for="firstName">ไม่สำรวจข้อมูลบุคคลที่มีชื่อตามทะเบียนบ้านแต่ไม่ได้พักอาศัยอยู่ในบ้านโดยไม่มีการติดต่อใด ๆ กับครัวเรือนมาแล้วเป็นเวลาไม่น้อยกว่า 3 ปี</label>
	</div>
</div>
<br>
<div class="row" style='border-style: dotted;border-width: 1px'>
		<div class="col-lg-12">
			@{
				var sessionHC= JSRuntime.InvokeAsync<string>("localStorage.getItem", "HC");
			}
		<label><b><font size='6' color='red'>HC :@sessionHC</font></b></label>
	</div>
</div>
@*<?php
$mysqli=mcon($mysql["host"], $mysql["user"], $mysql["pass"], $mysql["dbname"],$mysql["charset"]);

$query_up="select ch1_st from survey_staff where  HC='$HC' and survey_year='$survey_year' and survey_no='$survey_no'";
$result_up=$mysqli->query($query_up);
$row_up=$result_up->fetch_object();
if($row_up->ch1_st==0){
	$query_up1="update survey_staff set ch1_st='".date("U")."' where  HC='$HC' and survey_year='$survey_year' and survey_no='$survey_no'";
	$result_up1=$mysqli->query($query_up1);
}

$query="select PP,HHM from survey_profile where HC='$HC' and survey_year='$survey_year' and survey_no='$survey_no'";
$result=$mysqli->query($query);
$row=$result->fetch_object();
$count=$row->HHM;

//background-color
for($i=1;$i<=$count;$i++){//for($i=1;$i<=$count;$i++){
	$background=($background=='#FFEFFF')?"#EFFFFF":"#FFEFFF";
	$query1="select a2,a3,a4,a5,a6,popid,a2_b from survey_a1 where HC='$HC' and a1='$i' and survey_year='$survey_year' and survey_no='$survey_no'";
	$result1=$mysqli->query($query1);
	$row1=$result1->fetch_object();
>?*@
@{
	var background ="";
	int i = 0;
}
<EditForm Model="@survey_A1s" OnValidSubmit="@HandleValidSubmit" >
	
@foreach(var item in survey_A1s)
	{
		i++;
		var index=i;
<input type="hidden" value="i" name="a1[@index]">
	

<div class="row" style="border-style: dotted;border-width: 1px;background-color:@((index%2==0)?"#FFEFFF":"#EFFFFF")">


	<div class="col-lg-12  mb-3">
		<label for="a2[@index]"><h3><font color="blue">คนที่ @index</font> (อยู่ในทะเบียนบ้าน) (A1)</h3> </label><br>
		&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" class="custom-control-input" id="del[@index]" name="del[@index]">
		<label class="custom-control-label" for="del[@index]">ลบ คนที่ @i </label><br>
		<label for="a2[@index]">1. ชื่อ-นามสกุล (ให้ระบุคำนำหน้าชื่อลงไปด้วย) เช่น นาย,นาง,นางสาว,เด็กหญิง, เด็กชาย (A2)</label>
		<input type="text" name="a2[@index]" id="a2[@index]" @bind-value="@item.a1" placeholder="--ชื่อ-นามสกุล (ให้ระบุคำนำหน้าชื่อลงไปด้วย)--"  class="form-control">

			</div>
</div>

<br>
<div class="row" style='border-style: dotted;border-width: 1px;background-color:@*<?php echo$background>?*@'>
	<div class="col-lg-12  mb-3">
		<label for="popid[@index]">2. หมายเลขบัตรประจำตัวประชาชน</label>
		<input type='text'  id='popid[@index]' name='popid[@index]'  @bind-value="@item.popid" placeholder="--หมายเลขบัตรประจำตัวประชาชน--" onkeyup="autoTab(this,1)" onkeypress="autoTab(this,1)" maxlength='17'  class="form-control">
	</div>
</div>

		}
<br>
<div class="row">
			<div class="col-lg-12  mb-3">
				<input type='submit' value='บันทึก' >
				<input type="button" @* @onclick="@(e => gotoPage(@HC))"*@ value="ถัดไป" />

			</div>
		</div>
</EditForm>

@code {
	
}
